import{af as ge,R as N,r as m,y as _e,j as e}from"./index-bBoaL7NX.js";import{B as he}from"./Breadcrumb-Db9PlBea.js";import{P as be}from"./PageContainer-ClH7HaBW.js";import{B as xe}from"./BlankCard-BfHU7njI.js";import{C as p}from"./CustomFormLabel-DkCP5Nv8.js";import{C as v}from"./CustomSelect-_oosuc7Q.js";import{C as q}from"./CustomTextField-nzkQUDrv.js";import{g as ye,c as W}from"./Utils-DZtz8wsc.js";import{i as _}from"./axios-MmGZYXFl.js";import{j as ve}from"./index-VWaDGczM.js";import{C as fe}from"./CardContent-TrRQSIz8.js";import{B as R}from"./Box-Cbtftx36.js";import{S as je}from"./Stack-DONMPCRZ.js";import{T as ke}from"./Typography-B41TU7cT.js";import{B as T}from"./Button-2ihUhOt_.js";import{D as Se}from"./Divider-4e_Zm7wz.js";import{G as d}from"./Grid2-CC46JW8y.js";import{R as U}from"./RadioGroup-COzkG0Xs.js";import{F as P}from"./FormControlLabel-qTc2OSFR.js";import{R as F}from"./Radio-GSiGeisI.js";import{M as f}from"./MenuItem-DBmnqxHM.js";import{A as Ce}from"./Alert-CbLSE_hz.js";import"./Paper-CEo52ZYq.js";import"./useSlotProps-D8Vfx1ig.js";import"./Link-2pHd2OFC.js";import"./IconCircle-RJ076v1n.js";import"./createReactComponent-BVlLIvSm.js";import"./Card-DDyARx6g.js";import"./Select-x3FgNbWv.js";import"./Menu-DsMCwLnz.js";import"./useSlot-C2y4Okaq.js";import"./Popover-BZ_q2ihg.js";import"./isHostComponent-DVu5iVWx.js";import"./ownerDocument-DW-IO8s5.js";import"./ownerWindow-HkKU3E4x.js";import"./debounce-Be36O1Ab.js";import"./Grow-DbIyLDOd.js";import"./utils-fXVEFgwU.js";import"./getReactElementRef-bhjrj0fa.js";import"./mergeSlotProps-9a9CFyBb.js";import"./Modal-B5yRmzaP.js";import"./createChainedFunction-BO_9K8Jh.js";import"./Portal-PELJNkOL.js";import"./List-BNgu_2yQ.js";import"./utils-iop7lDec.js";import"./useControlled-B6T_fxKa.js";import"./useId-BgKtfLA5.js";import"./formControlState-Dq1zat_P.js";import"./useFormControl-CaUBXsoR.js";import"./TextField-CNoxaAXv.js";import"./FormControl-BPBqqdCO.js";import"./isMuiElement-CYEUdTOG.js";import"./index-J11PKsb-.js";import"./index-DT2YvziZ.js";import"./apiConstants-C71iLEz3.js";import"./createStack-D5Eniu1T.js";import"./styled-oSX1ZV8o.js";import"./useThemeProps-BUO-Zg8Q.js";import"./CircularProgress-BIjyWvHZ.js";import"./dividerClasses-D6e-UzmO.js";import"./FormGroup-CsISzJoH.js";import"./SwitchBase-DqWPx54W.js";import"./listItemTextClasses-DSEuY2ct.js";import"./Close-BajIXLAg.js";import"./IconButton-6ozhzS-w.js";const qe=[{to:"/",title:"Home"},{title:"Order"}],Pe=[{id:0,value:"500",label:"500Mb"},{id:1,value:"1000",label:"1Gb"},{id:2,value:"2000",label:"2Gb"},{id:3,value:"3000",label:"3Gb"},{id:4,value:"5000",label:"5Gb"}],Fe=[{id:0,value:"3Gb",label:"3Gb"},{id:1,value:"5Gb",label:"5Gb"},{id:2,value:"6Gb",label:"6Gb"},{id:3,value:"7Gb",label:"7Gb"},{id:4,value:"10Gb",label:"10Gb"},{id:5,value:"15Gb",label:"15Gb"},{id:6,value:"20Gb",label:"20Gb"},{id:7,value:"30Gb",label:"30Gb"}],we=[{id:0,value:"1",label:"1 day"},{id:1,value:"2",label:"2 day"},{id:2,value:"3",label:"3 day"},{id:3,value:"4",label:"4 day"},{id:4,value:"5",label:"5 day"},{id:5,value:"6",label:"6 day"},{id:6,value:"7",label:"7 day"},{id:7,value:"8",label:"8 day"},{id:8,value:"10",label:"10 day"},{id:9,value:"12",label:"12 day"},{id:10,value:"15",label:"15 day"},{id:11,value:"20",label:"20 day"},{id:12,value:"30",label:"30 day"}],Ge=[{id:0,value:"1",label:"1"},{id:1,value:"2",label:"2"},{id:2,value:"3",label:"3"},{id:3,value:"4",label:"4"},{id:4,value:"5",label:"5"},{id:5,value:"6",label:"6"},{id:6,value:"7",label:"7"},{id:7,value:"8",label:"8"},{id:8,value:"9",label:"9"},{id:9,value:"10",label:"10"},{id:10,value:"11",label:"11"},{id:11,value:"12",label:"12"},{id:12,value:"13",label:"13"},{id:13,value:"14",label:"14"},{id:14,value:"15",label:"15"},{id:15,value:"16",label:"16"},{id:16,value:"17",label:"17"},{id:17,value:"18",label:"18"},{id:18,value:"19",label:"19"},{id:19,value:"20",label:"20"},{id:20,value:"21",label:"21"},{id:21,value:"22",label:"22"},{id:22,value:"23",label:"23"},{id:23,value:"24",label:"24"},{id:24,value:"25",label:"25"},{id:25,value:"26",label:"26"},{id:26,value:"27",label:"27"},{id:27,value:"28",label:"28"},{id:28,value:"29",label:"29"},{id:29,value:"30",label:"30"}],Va=()=>{const{order_id:$}=ge(),[Q,H]=N.useState([]),[Ee,De]=N.useState([]),[Ie,V]=m.useState(""),[z,J]=m.useState(""),[K,X]=m.useState(""),[Y,Z]=m.useState(""),[B,j]=m.useState(!0),[ee,w]=m.useState(!1),[ae,G]=m.useState(!1),[te,Oe]=m.useState(!1),h=_e(),[s,k]=m.useState({seq:0,order_id:"",nama_pengguna:"",telp_pengguna:"",email_pengguna:"",agent_name:"",type:"",package_type:"",country:"ASIA16",days:0,fup:"",quota:"",quantity:1,product_id:"",product_price:0,ccid:"",partner_id:""});m.useEffect(()=>{const a=localStorage.getItem("token");if(a){const o=ve(a);J(o.user_name),V(o.session_level),Z(o.session_name),X(o.session_name),re(o.session_name);const t=o.session_name.split("-")[0];console.log("partnerID:",t),le(t),oe($,t)}else h("/auth/login");de()},[]);const oe=async(a,o)=>{let t="orders/id/"+a;_.get(t).then(l=>{console.log("order_detail: ",l.data);const n=l.data.orders[0];j(!1),n.package_name.toLowerCase().includes("unlimited")?w(!0):G(!0);const i=n.order_quantity,r=n.order_ccid||"";if(console.log("orderCcid : ",r),r.includes(",")){const b=r.split(",");for(let g=1;g<=i;g++)s[`ccid_${g}`]=b[g-1]||""}else s.ccid_1=r;se(n,n.package_id,o)}).catch(l=>{l.response&&l.response.status===403||l.response.status===401?h("/auth/login"):console.log(l)})},se=async(a,o,t)=>{console.log("package_id : ",o),console.log("userSession retrived: ",t);let l="product/partner/package/"+o+"/"+t;_.get(l).then(n=>{const i=n.data[0];if(!a||Object.keys(a).length===0){console.error("responseData is empty or undefined");return}const r={...a},b=r.seq,g=r.order_id,D=r.order_date,S=r.product_type,I=r.order_status,O=r.customer_name;console.log("seq : ",b),console.log("order_id : ",g),console.log("order_date : ",D),console.log("type : ",S),console.log("order_status : ",I),console.log("nama_pengguna : ",O),k(C=>({...C,seq:b,order_id:r.order_id,order_date:r.order_date,type:r.product_type,order_status:r.order_status,nama_pengguna:r.customer_name,telp_pengguna:r.contact_phone,contact_wa:r.contact_wa,email_pengguna:r.email_address,agent_code:r.agent_code,agent_name:r.agent_name,country_name:r.country_name,package_id:r.package_id,package_name:r.package_name,quantity:r.order_quantity,total_order:r.total_order,total_cost:r.total_cost,package_type:r.package_name.toLowerCase().includes("unlimited")?"1":"2",country:i.country,days:i.days,fup:i.quota,quota:i.order_quota,product_id:r.package_id,product_price:r.total_order,partner_id:t}))}).catch(n=>{console.log(n)})},re=async a=>{let o="agents/code/"+a;_.get(o).then(t=>{k(l=>({...l,agent_name:t.data[0].name}))}).catch(t=>{t.response&&t.response.status===403||t.response.status===401?h("/auth/login"):console.log(t)})},le=async a=>{let o="product/partner/cobrand/"+a;_.get(o).then(t=>{console.log("list_product_partner : ",t.data)}).catch(t=>{t.response&&t.response.status===403||t.response.status===401?h("/auth/login"):console.log(t)})},ne=async(a,o,t,l)=>{let n="product/partner/"+a+"/"+o+"/"+t+"/"+l;_.get(n).then(async i=>{const r=K+ye(),b=W(),g=Y;console.log("list_product_partner_detail : ",i.data),k(c=>({...c,product_id:i.data[0].package_id,product_price:i.data[0].selling_price}));const D=i.data[0].package_id,S=i.data[0].selling_price,I=i.data[0].package_name,O=i.data[0].cobrain_price,C=s.quantity*S;console.log("total_product_price : ",C);let x=[];for(let c=0;c<E.length;c++)x[c]=s[`ccid_${c+1}`];console.log("ccid generate: ",x);let y="";for(let c=0;c<x.length;c++)x[c]!=""?y+=x[c]+"|":x[c]="";y=y.substring(0,y.length-1),console.log("ccid : ",y);const M={seq:0,order_id:r,order_date:b,order_type:s.type,order_status:"New",order_customer_name:s.nama_pengguna,order_contact_phone:s.telp_pengguna,order_contact_wa:s.telp_pengguna,order_contact_email:s.email_pengguna,order_agent_code:g,order_agent_name:s.agent_name,order_product:D,order_country_code:s.country,order_fup:s.fup,order_quota:s.quota,order_days:s.days,order_ccid:y,order_qty:s.quantity,order_product_price:S,order_cobrain_price:O,order_product_total_price:C,package_name:I,cobrand_id:s.partner_id,order_source:"Web"};console.log("formData.seq: ",s.seq),console.log("dataOrder update: ",M),await ue(s.seq,M);const me=W();await ce({seq:0,order_id:r,event_name:"Edit New Order",event_date:me,username:z}),h("/order/list")}).catch(i=>{alert("Product not found")})},u=a=>{const{name:o,value:t}=a.target;k(l=>{const n={...l,[o]:t};return n.package_type==="1"?(j(!1),w(!0),G(!1)):n.package_type==="2"?(j(!1),w(!1),G(!0)):j(!0),{...n}})},ie=async a=>{a.preventDefault();try{console.log("data : ",s),ne(s.country,s.days,s.fup,s.partner_id)}catch(o){console.error("Error adding orders:",o)}},de=async()=>{_.get("country").then(o=>{H(o.data)}).catch(o=>{o.response&&o.response.status===403||o.response.status===401?h("/auth/login"):console.log(o)})},ce=async a=>{try{const t=(await _.post("order/event",a)).data}catch(o){console.error("Error adding order events :",o)}},ue=async(a,o)=>{try{const l=(await _.put("orders/update/"+a,o)).data}catch(t){console.error("Error adding orders:",t)}},pe=Array.from({length:30},(a,o)=>o+1),L=3,E=pe.slice(0,s.quantity),A=[];for(let a=0;a<E.length;a+=L)A.push(E.slice(a,a+L));return e.jsxs(be,{title:"Edit Order Simcard / eSIM",description:"this is edit Simcard/eSIM",children:[e.jsx(he,{title:"Edit Order Simcard / eSIM",items:qe}),e.jsx(xe,{children:e.jsx(fe,{children:e.jsx("form",{onSubmit:ie,children:e.jsxs(R,{children:[e.jsxs(je,{direction:"row",spacing:{xs:1,sm:2,md:4},justifyContent:"space-between",mb:3,children:[e.jsxs(ke,{variant:"h5",children:["#USER: ",z]}),e.jsxs(R,{display:"flex",gap:1,children:[e.jsx(T,{variant:"outlined",color:"error",onClick:()=>{h("/order/list")},children:"Cancel"}),e.jsx(T,{type:"submit",variant:"contained",color:"primary",children:"Save Record"})]})]}),e.jsx(Se,{}),e.jsxs(d,{container:!0,spacing:3,children:[e.jsxs(d,{size:{xs:12,sm:4},children:[e.jsx(p,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Nama Pengguna"}),e.jsx(q,{id:"nama_pengguna",name:"nama_pengguna",value:s.nama_pengguna,onChange:u,fullWidth:!0})]}),e.jsxs(d,{size:{xs:12,sm:4},children:[e.jsx(p,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Nomor Telepon Pengguna"}),e.jsx(q,{id:"telp_pengguna",name:"telp_pengguna",value:s.telp_pengguna,onChange:u,fullWidth:!0,type:"phone"})]}),e.jsxs(d,{size:{xs:12,sm:4},children:[e.jsx(p,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Email Pengguna"}),e.jsx(q,{id:"email_pengguna",name:"email_pengguna",value:s.email_pengguna,onChange:u,fullWidth:!0,type:"email"})]}),e.jsxs(d,{size:{xs:12,sm:4},children:[e.jsx(p,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Type"}),e.jsxs(U,{"aria-labelledby":"demo-radio-buttons-group-label",value:s.type,onChange:u,id:"type",name:"type",row:!0,children:[e.jsx(P,{value:"SIM",control:e.jsx(F,{}),label:"Simcard"}),e.jsx(P,{value:"ESIM",control:e.jsx(F,{}),label:"eSIM"})]})]}),e.jsxs(d,{size:{xs:12,sm:4},children:[e.jsx(p,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Country"}),e.jsx(v,{id:"country",name:"country",value:s.country,onChange:u,fullWidth:!0,children:Q.map(a=>e.jsx(f,{value:a.country_code,children:a.country_list},a.seq))})]}),e.jsx(d,{size:{xs:12,sm:4},children:" "}),e.jsxs(d,{size:{xs:12,sm:4},children:[e.jsx(p,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Product Type"}),e.jsxs(U,{"aria-labelledby":"radio-buttons-group-package",value:s.package_type,onChange:u,id:"package_type",name:"package_type",row:!0,children:[e.jsx(P,{value:"1",control:e.jsx(F,{}),label:"Unlimited"}),e.jsx(P,{value:"2",control:e.jsx(F,{}),label:"Quota Based"})]})]}),e.jsxs(d,{size:{xs:12,sm:4},children:[e.jsx(p,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Product Package"}),ee&&e.jsx(v,{id:"fup",name:"fup",value:s.fup,onChange:u,fullWidth:!0,children:Pe.map(a=>e.jsx(f,{value:a.value,children:a.label},a.id))}),ae&&e.jsx(v,{id:"quota",name:"quota",value:s.quota,onChange:u,fullWidth:!0,children:Fe.map(a=>e.jsx(f,{value:a.value,children:a.label},a.id))})]}),e.jsxs(d,{size:{xs:12,sm:4},children:[e.jsx(p,{htmlFor:"Days",sx:{mt:{xs:0,sm:3}},children:"Days"}),e.jsx(v,{id:"days",name:"days",value:s.days,onChange:u,fullWidth:!0,disabled:B,children:we.map(a=>e.jsx(f,{value:a.value,children:a.label},a.id))})]}),e.jsxs(d,{size:{xs:12,sm:2},children:[e.jsx(p,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Quantity"}),e.jsx(v,{id:"quantity",name:"quantity",value:s.quantity,onChange:u,fullWidth:!0,disabled:B,children:Ge.map(a=>e.jsx(f,{value:a.value,children:a.label},a.id))})]})]}),e.jsx(d,{size:{xs:12,sm:12},children:e.jsx(p,{htmlFor:"title_price",sx:{mt:3,mb:2},children:"ICCID - (eSIM tdk perlu di isi)"})}),A.map((a,o)=>e.jsx(d,{container:!0,spacing:2,children:a.map(t=>e.jsxs(N.Fragment,{children:[e.jsx(d,{size:{xs:12,sm:1},children:e.jsxs(p,{htmlFor:`ccid_${t}`,sx:{mt:1,textAlign:"center"},children:[t,"."]})}),e.jsx(d,{size:{xs:12,sm:3},children:e.jsx(q,{id:`ccid_${t}`,name:`ccid_${t}`,value:s[`ccid_${t}`]||"",onChange:u,fullWidth:!0,sx:{mt:1}})})]},t))},o)),te&&e.jsx(Ce,{severity:"success",sx:{position:"fixed",top:16,right:16},children:"Order created successfully."})]})})})})]})};export{Va as default};
