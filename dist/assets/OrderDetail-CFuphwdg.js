import{ag as q,y as R,r as d,z as c,j as e}from"./index-D0CpDmcp.js";import{P as T}from"./PageContainer-GyGJwSoy.js";import{B as G}from"./Breadcrumb-BVcp9-n_.js";import{P as H}from"./ParentCard-Dds6eSz-.js";import{B as M}from"./BlankCard-C5pX7qij.js";import{f as J,n as b,c as p}from"./Utils-DY8x-pVc.js";import{A as l}from"./apiConstants-ChAepINk.js";import{B as Q}from"./Box-YfWKO8y5.js";import{G as r}from"./Grid2-B3gzDQ3y.js";import{T as t}from"./Typography-CxjCbjeZ.js";import{C as W}from"./Chip-C2vBKMax.js";import{D as O}from"./Divider-cwsqb4Sr.js";import{B as m}from"./Button-CgUWpLWI.js";import"./Paper-DYTAYSZ1.js";import"./useSlotProps-BSM9QyQs.js";import"./Link-Bnmvu_Gi.js";import"./IconCircle-D7zSMm9k.js";import"./createReactComponent-3iThfHP-.js";import"./Card-CBAn0QXF.js";import"./CardHeader-BR6S_Hd-.js";import"./useSlot-CFWOFHMb.js";import"./CardContent-B3dzlDvA.js";import"./index-BPskgXx8.js";import"./index-DT2YvziZ.js";import"./dividerClasses-Cmg2xQcr.js";import"./useId-BnzzJGZL.js";import"./CircularProgress-DwEGvCDN.js";const K=l.apiUrl,V=[{to:"/",title:"Home"},{title:"Order Detail"}],be=()=>{const{order_id:u}=q(),x=R(),[j,E]=d.useState(""),[D,S]=d.useState(""),[X,P]=d.useState("");d.useEffect(()=>{const s=localStorage.getItem("data_success_login");if(s){const i=JSON.parse(s);console.log("user_name:",i.user_name),console.log("session_name:",i.session_name),console.log("session_level:",i.session_level),console.log("last_login_time:",i.last_login_time),console.log("blocked:",i.blocked),E(i.user_name),S(i.session_level),P(i.session_name),console.log("order_id: ",u),U(u),i.session_level.toLowerCase()==="partner"?i.session_name.split("-")[0]:i.session_level.toLowerCase()}else x("/auth/login")},[]);const[I,A]=d.useState([]),_=I,U=async s=>{let i=K+"orders/id/"+s;c.get(i).then(a=>{console.log("order_detail: ",a.data),A(a.data)}).catch(a=>{console.log(a)})},B=async s=>{try{const a=(await c.get(l.apiUrl+"orders/update/"+s+"/Approved")).data;if(a){if(a.order_id===s){let n="",h="",f="",C=0;_.forEach(o=>{console.log("CCID: ",o.order_ccid),n=o.order_ccid,h=o.order_country_code,f=o.order_product,C=o.order_product_price});const N=n.includes("|"),z={out_date:p(),status:"Used",order_id:s,country_id:h,package_id:f,selling_price:C};if(N){const o=n.split("|");console.log("length: ",o.length),o.forEach(async y=>{console.log("CCID PARSE: ",y),await v(y,z)})}else console.log("delimiter false"),await v(n,z);const F=p();await g({seq:0,order_id:s,event_name:"Approve Order",event_date:F,username:j}),x("/order/list")}}else console.error("Error update status gagal")}catch(i){console.error("Error adding order events :",i)}},L=async s=>{try{const a=(await c.get(l.apiUrl+"orders/update/"+s+"/Paid")).data;if(a){if(a.order_id===s){const n=p();await g({seq:0,order_id:s,event_name:"Confirm Order",event_date:n,username:j}),x("/order/list")}}else console.error("Error update status gagal")}catch(i){console.error("Error adding order events :",i)}},k=()=>{x("/order/list")},v=async(s,i)=>{try{const n=(await c.put(l.apiUrl+"inventory/ccid/"+s,i)).data;console.log("res updated: ",n)}catch(a){console.error("Error updating inventory sim:",a)}},g=async s=>{try{const a=(await c.post(l.apiUrl+"order/event",s)).data}catch(i){console.error("Error adding order events :",i)}};return e.jsxs(T,{title:"Order",description:"this is order detail page",children:[e.jsx(G,{title:"Order",items:V}),e.jsx(H,{title:"Order Detail",children:e.jsx(M,{children:e.jsx(Q,{mt:2,mb:2,children:_.map(s=>e.jsx(r,{children:e.jsxs(r,{container:!0,spacing:1,children:[e.jsx(r,{size:{xs:2},children:e.jsx(t,{variant:"h6",children:"Order ID"})}),e.jsx(r,{size:{xs:4},children:e.jsxs(t,{variant:"subtitle1",children:[": ",s.order_id]})}),e.jsx(r,{size:{xs:2},children:e.jsx(t,{variant:"h6",children:"Order Date"})}),e.jsx(r,{size:{xs:4},children:e.jsxs(t,{variant:"subtitle1",children:[": ",J(s.order_date)]})}),e.jsx(r,{size:{xs:2},children:e.jsx(t,{variant:"h6",children:"Status"})}),e.jsx(r,{size:{xs:4},children:e.jsxs(t,{variant:"subtitle1",children:[": ",e.jsx(W,{color:s.order_status==="Paid"?"success":s.order_status==="New"?"warning":s.order_status==="Cancel"?"error":"secondary",sx:{borderRadius:"6px"},size:"small",label:s.order_status})]})}),e.jsx(r,{size:{xs:2},children:e.jsx(t,{variant:"h6",children:"Agent Code"})}),e.jsx(r,{size:{xs:4},children:e.jsxs(t,{variant:"subtitle1",children:[": ",s.order_agent_code]})}),e.jsx(r,{size:{xs:12},mt:2,mb:2,children:e.jsx(O,{})}),e.jsx(r,{size:{xs:2},children:e.jsx(t,{variant:"h6",children:"Customer Name"})}),e.jsx(r,{size:{xs:4},children:e.jsxs(t,{variant:"subtitle1",children:[": ",s.order_customer_name]})}),e.jsx(r,{size:{xs:2},children:e.jsx(t,{variant:"h6",children:"Email Address"})}),e.jsx(r,{size:{xs:4},children:e.jsxs(t,{variant:"subtitle1",children:[": ",s.order_contact_email]})}),e.jsx(r,{size:{xs:2},children:e.jsx(t,{variant:"h6",children:"Contact Phone"})}),e.jsx(r,{size:{xs:4},children:e.jsxs(t,{variant:"subtitle1",children:[": ",s.order_contact_phone]})}),e.jsx(r,{size:{xs:2},children:e.jsx(t,{variant:"h6",children:"Contact Whatsapp"})}),e.jsx(r,{size:{xs:4},children:e.jsxs(t,{variant:"subtitle1",children:[": ",s.order_contact_wa]})}),e.jsx(r,{size:{xs:12},mt:2,mb:2,children:e.jsx(O,{})}),e.jsx(r,{size:{xs:2},children:e.jsx(t,{variant:"h6",children:"Quantity"})}),e.jsx(r,{size:{xs:10},children:e.jsxs(t,{variant:"subtitle1",children:[": ",s.order_qty]})}),e.jsx(r,{size:{xs:2},children:e.jsx(t,{variant:"h6",children:"Unit Price"})}),e.jsx(r,{size:{xs:10},children:e.jsxs(t,{variant:"subtitle1",children:[": ",b(s.order_product_price)]})}),e.jsx(r,{size:{xs:2},children:e.jsx(t,{variant:"h6",children:"Harga NTA"})}),e.jsx(r,{size:{xs:10},children:e.jsxs(t,{variant:"subtitle1",children:[": ",b(s.order_product_total_price)]})}),e.jsx(r,{size:{xs:2},children:e.jsx(t,{variant:"h6",children:"Country Code"})}),e.jsx(r,{size:{xs:10},children:e.jsxs(t,{variant:"subtitle1",children:[": ",s.order_country_code]})}),e.jsx(r,{size:{xs:2},children:e.jsx(t,{variant:"h6",children:"ICCID List"})}),e.jsx(r,{size:{xs:10},children:e.jsxs(t,{variant:"subtitle1",children:[": ",s.order_ccid.replace("|",",")]})}),e.jsx(r,{size:{xs:12},mt:2,mb:2,children:D.toLowerCase()==="agent-manager"?e.jsxs(e.Fragment,{children:[s.order_status==="Approved"?e.jsx(m,{variant:"contained",color:"primary",onClick:()=>L(s.order_id),children:"Confirm Order"}):s.order_status==="Paid"?e.jsx(e.Fragment,{}):e.jsx(m,{variant:"contained",color:"primary",onClick:()=>B(s.order_id),children:"Approve Order"}),s.order_status==="Paid"?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:["   ",e.jsx(m,{variant:"contained",color:"secondary",onClick:k,children:"Cancel"})]})]}):e.jsx(e.Fragment,{})})]})},s.seq))})})})]})};export{be as default};
