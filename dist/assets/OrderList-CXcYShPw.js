import{y as pe,r as a,j as e}from"./index-bBoaL7NX.js";import{P as ge}from"./PageContainer-ClH7HaBW.js";import{P as ve}from"./ParentCard-CFe-nEgX.js";import{B as Ce}from"./BlankCard-BfHU7njI.js";import{C as P}from"./CustomSelect-_oosuc7Q.js";import{C as D}from"./CustomTextField-nzkQUDrv.js";import{T as fe,L as q,F as Y,K as J}from"./LastPage-CUO0XoGI.js";import{K as V}from"./KeyboardArrowRight-CL0uG8E4.js";import{f as _e,n as W,c as Q}from"./Utils-DZtz8wsc.js";import{i as g}from"./axios-MmGZYXFl.js";import{j as be}from"./index-VWaDGczM.js";import{B as X}from"./Box-Cbtftx36.js";import{G as d}from"./Grid2-CC46JW8y.js";import{T as r}from"./Typography-B41TU7cT.js";import{M as o}from"./MenuItem-DBmnqxHM.js";import{B as ye}from"./Button-2ihUhOt_.js";import{T as Se}from"./TableContainer-OLbhJ7zr.js";import{T as Ie,a as Oe,b as L,c as n,d as Pe}from"./TableRow-Zqkg4FIQ.js";import{T as h}from"./Tooltip-CRAcMsX-.js";import{I as l}from"./IconButton-6ozhzS-w.js";import{I as T}from"./IconEye-BtFi0ubB.js";import{I as De,a as R}from"./IconHistory-BgQY2Ikj.js";import{I as Le}from"./IconRowRemove-EM_Win1C.js";import{I as Te}from"./IconEdit-BUB-FThl.js";import{C as ke}from"./Chip-Bm7HxxC0.js";import{T as we}from"./TablePagination-DdevPbi4.js";import{u as Ae}from"./Paper-CEo52ZYq.js";import"./Card-DDyARx6g.js";import"./CardHeader-BGxrrKRe.js";import"./useSlot-C2y4Okaq.js";import"./Divider-4e_Zm7wz.js";import"./dividerClasses-D6e-UzmO.js";import"./CardContent-TrRQSIz8.js";import"./Select-x3FgNbWv.js";import"./Menu-DsMCwLnz.js";import"./useSlotProps-D8Vfx1ig.js";import"./Popover-BZ_q2ihg.js";import"./isHostComponent-DVu5iVWx.js";import"./ownerDocument-DW-IO8s5.js";import"./ownerWindow-HkKU3E4x.js";import"./debounce-Be36O1Ab.js";import"./Grow-DbIyLDOd.js";import"./utils-fXVEFgwU.js";import"./getReactElementRef-bhjrj0fa.js";import"./mergeSlotProps-9a9CFyBb.js";import"./Modal-B5yRmzaP.js";import"./createChainedFunction-BO_9K8Jh.js";import"./Portal-PELJNkOL.js";import"./List-BNgu_2yQ.js";import"./utils-iop7lDec.js";import"./useControlled-B6T_fxKa.js";import"./useId-BgKtfLA5.js";import"./formControlState-Dq1zat_P.js";import"./useFormControl-CaUBXsoR.js";import"./TextField-CNoxaAXv.js";import"./FormControl-BPBqqdCO.js";import"./isMuiElement-CYEUdTOG.js";import"./createSvgIcon-DcL-YXBs.js";import"./index-J11PKsb-.js";import"./index-DT2YvziZ.js";import"./apiConstants-C71iLEz3.js";import"./styled-oSX1ZV8o.js";import"./useThemeProps-BUO-Zg8Q.js";import"./listItemTextClasses-DSEuY2ct.js";import"./CircularProgress-BIjyWvHZ.js";import"./Popper-ppbRY3WN.js";import"./createReactComponent-BVlLIvSm.js";import"./KeyboardArrowRight-BUHflnHK.js";import"./LastPage-CryT0fTs.js";import"./Toolbar-BWjUcWdc.js";function Ee(c){const u=Ae(),{count:C,page:j,rowsPerPage:f,onPageChange:m}=c,k=x=>{m(x,0)},b=x=>{m(x,j-1)},w=x=>{m(x,j+1)},y=x=>{m(x,Math.max(0,Math.ceil(C/f)-1))};return e.jsxs(X,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(l,{onClick:k,disabled:j===0,"aria-label":"first page",children:u.direction==="rtl"?e.jsx(q,{}):e.jsx(Y,{})}),e.jsx(l,{onClick:b,disabled:j===0,"aria-label":"previous page",children:u.direction==="rtl"?e.jsx(V,{}):e.jsx(J,{})}),e.jsx(l,{onClick:w,disabled:j>=Math.ceil(C/f)-1,"aria-label":"next page",children:u.direction==="rtl"?e.jsx(J,{}):e.jsx(V,{})}),e.jsx(l,{onClick:y,disabled:j>=Math.ceil(C/f)-1,"aria-label":"last page",children:u.direction==="rtl"?e.jsx(Y,{}):e.jsx(q,{})})]})}const Xt=()=>{const c=pe(),[u,C]=a.useState(""),[j,f]=a.useState(""),[m,k]=a.useState(""),[b,w]=a.useState(""),[y,x]=a.useState(""),[N,Z]=a.useState(""),[B,$]=a.useState(""),[M,ee]=a.useState(""),[F,z]=a.useState(""),[H,te]=a.useState("");a.useEffect(()=>{const t=localStorage.getItem("token");if(t){const s=be(t);if(console.log("user_name:",s.user_name),console.log("session_name:",s.session_name),console.log("session_level:",s.session_level),console.log("last_login_time:",s.last_login_time),console.log("blocked:",s.blocked),C(s.session_level),f(s.session_name),k(s.user_name),s.session_level.toLowerCase()==="partner"||s.session_level.toLowerCase()==="partner-admin"){const i=s.session_name.split("-")[0];ie(i)}else s.session_level.toLowerCase()==="agent-manager"||s.session_level.toLowerCase()==="agent-admin"?se(s.session_name):s.session_level.toLowerCase()==="cs-web"?ne():re()}else c("/auth/login")},[]);const se=async t=>{let s="orders/agent/"+t;g.get(s).then(i=>{i.data.success&&(S(i.data.orders),_(i.data.orders))}).catch(i=>{i.response&&i.response.status===403||i.response.status===401?c("/auth/login"):console.log(i)})},re=async()=>{g.get("orders").then(s=>{s.data.success&&(S(s.data.orders),_(s.data.orders))}).catch(s=>{s.response&&s.response.status===403||s.response.status===401?c("/auth/login"):console.log(s)})},ne=async()=>{g.get("orders/cs").then(s=>{s.data.success&&(S(s.data.orders),_(s.data.orders))}).catch(s=>{s.response&&s.response.status===403||s.response.status===401?c("/auth/login"):console.log(s)})},ie=async t=>{let s="orders/?agent_code="+t;g.get(s).then(i=>{i.data.success&&(S(i.data.orders),_(i.data.orders))}).catch(i=>{i.response&&i.response.status===403||i.response.status===401?c("/auth/login"):console.log(i)})},[ae,S]=a.useState([]),[oe,_]=a.useState([]),I=oe,[v,K]=a.useState(0),[p,le]=a.useState(10),G=v>0?Math.max(0,(1+v)*p-I.length):0,de=(t,s)=>{K(s)},ce=t=>{le(parseInt(t.target.value,10)),K(0)},he=()=>{console.log("get record");const t=ae.filter(s=>{const i=new Date(s.order_date);return(!b||s.order_id.includes(b))&&(!y||s.order_customer_name.toLowerCase().includes(y.toLowerCase()))&&(!N||i>=new Date(N))&&(!B||i<=new Date(B))&&(!M||s.order_status===M)&&(!H||s.order_agent_code.toLowerCase().includes(H.toLowerCase()))&&(!F||s.product_type===F)});_(t)},O=t=>{c("/order/detail/"+t)},xe=t=>{c("/order/edit/"+t)},A=t=>{c("/order/history/"+t)},ue=async t=>{try{const i=(await g.get("orders/update/"+t+"/Cancelled")).data;if(i){if(i.order_id===t){const E=Q();await U({seq:0,order_id:t,event_name:"Cancelled - Order Simcard/eSIM",event_date:E,username:m}),window.location.reload()}}else console.error("Error update status gagal")}catch(s){console.error("Error adding order events :",s)}},je=async t=>{try{const i=(await g.get("orders/update/"+t+"/Closed")).data;if(i){if(i.order_id===t){const E=Q();await U({seq:0,order_id:t,event_name:"Closed - Upload Simcard",event_date:E,username:m}),window.location.reload()}}else console.error("Error update status gagal")}catch(s){console.error("Error adding order events :",s)}},U=async t=>{try{const i=(await g.post("order/event",t)).data}catch(s){console.error("Error adding order events :",s)}};return e.jsx(ge,{title:"Order",description:"this is order page",children:e.jsxs(ve,{title:"Order List",children:[e.jsx(X,{mt:2,mb:2,children:e.jsx(d,{size:{xs:12},children:e.jsxs(d,{container:!0,spacing:2,children:[e.jsxs(d,{size:{xs:3},children:[e.jsx(r,{variant:"subtitle1",children:"Order ID"}),e.jsx(D,{fullWidth:!0,onChange:t=>w(t.target.value)})]}),e.jsxs(d,{size:{xs:3},children:[e.jsx(r,{variant:"subtitle1",children:"Customer Name"}),e.jsx(D,{fullWidth:!0,onChange:t=>x(t.target.value)})]}),e.jsxs(d,{size:{xs:3},children:[e.jsx(r,{variant:"subtitle1",children:"Order Date Begin"}),e.jsx(D,{fullWidth:!0,type:"date",onChange:t=>Z(t.target.value)})]}),e.jsxs(d,{size:{xs:3},children:[e.jsx(r,{variant:"subtitle1",children:"Order Date End"}),e.jsx(D,{fullWidth:!0,type:"date",onChange:t=>$(t.target.value)})]}),e.jsxs(d,{size:{xs:3},children:[e.jsx(r,{variant:"subtitle1",children:"Order Status"}),e.jsxs(P,{fullWidth:!0,variant:"outlined",onChange:t=>ee(t.target.value),children:[e.jsx(o,{value:"New",children:"New"}),e.jsx(o,{value:"Approved",children:"Approved"}),e.jsx(o,{value:"Paid",children:"Paid"}),e.jsx(o,{value:"Delivered",children:"Delivered"}),e.jsx(o,{value:"Returned",children:"Returned"}),e.jsx(o,{value:"Closed",children:"Closed"}),e.jsx(o,{value:"Cancelled",children:"Cancelled"})]})]}),u.toLowerCase()==="web-admin"?e.jsxs(e.Fragment,{children:[e.jsxs(d,{size:{xs:6},children:[e.jsx(r,{variant:"subtitle1",children:"Agent"}),e.jsxs(P,{fullWidth:!0,variant:"outlined",onChange:t=>te(t.target.value),children:[e.jsx(o,{value:"GRM",children:"GRM - TIA - TIA FINANCE HO"}),e.jsx(o,{value:"RKL",children:"RKL - RKL - DAVID - DAVID WIDJAJA"}),e.jsx(o,{value:"RYC",children:"RYC - BUFANNY - BU FANNY"})]})]}),e.jsxs(d,{size:{xs:3},children:[e.jsx(r,{variant:"subtitle1",children:"Type"}),e.jsxs(P,{fullWidth:!0,variant:"outlined",onChange:t=>z(t.target.value),children:[e.jsx(o,{value:"SIM",children:"Simcard"}),e.jsx(o,{value:"ESIM",children:"eSIM"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(d,{size:{xs:3},children:[e.jsx(r,{variant:"subtitle1",children:"Type"}),e.jsxs(P,{fullWidth:!0,variant:"outlined",onChange:t=>z(t.target.value),children:[e.jsx(o,{value:"SIM",children:"Simcard"}),e.jsx(o,{value:"ESIM",children:"eSIM"})]})]}),e.jsx(d,{size:{xs:6},children:e.jsx(e.Fragment,{})})]}),e.jsx(d,{size:{xs:12},children:e.jsx(ye,{variant:"contained",color:"primary",onClick:he,children:"Get Record"})})]})})}),e.jsx(Ce,{children:e.jsx(Se,{children:e.jsxs(Ie,{"aria-label":"custom pagination table",sx:{whiteSpace:"nowrap"},children:[e.jsx(Oe,{children:e.jsxs(L,{children:[e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Action"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Seq"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Order ID"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Order Date"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Type"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Status"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Customer Name"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Contact Phone"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Contact WA"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Email"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Agent Code"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Agent Name"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Product"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Qty"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Total Order"})}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:"Total Cost"})})]})}),e.jsxs(Pe,{children:[(p>0?I.slice(v*p,v*p+p):I).map((t,s)=>e.jsxs(L,{children:[u.toLocaleLowerCase()==="cs-web"?t.order_status==="Paid"?e.jsxs(n,{children:[e.jsx(h,{title:"Detail CCID",children:e.jsx(l,{color:"success",onClick:()=>O(t.order_id),children:e.jsx(T,{width:22})})}),e.jsx(h,{title:"Close Order",children:e.jsx(l,{color:"primary",onClick:()=>je(t.order_id),children:e.jsx(De,{width:22})})})]}):t.order_status==="New"?e.jsxs(n,{children:[e.jsx(h,{title:"Detail CCID",children:e.jsx(l,{color:"success",onClick:()=>O(t.order_id),children:e.jsx(T,{width:22})})}),e.jsx(h,{title:"History",children:e.jsx(l,{color:"secondary",onClick:()=>A(t.order_id),children:e.jsx(R,{width:22})})}),e.jsx(h,{title:"Cancel Order",children:e.jsx(l,{color:"error",onClick:()=>ue(t.order_id),children:e.jsx(Le,{width:22})})})]}):e.jsxs(n,{children:[e.jsx(h,{title:"Detail CCID",children:e.jsx(l,{color:"success",onClick:()=>O(t.order_id),children:e.jsx(T,{width:22})})}),e.jsx(h,{title:"History",children:e.jsx(l,{color:"secondary",onClick:()=>A(t.order_id),children:e.jsx(R,{width:22})})})]}):e.jsxs(n,{children:[e.jsx(h,{title:"Detail CCID",children:e.jsx(l,{color:"success",onClick:()=>O(t.order_id),children:e.jsx(T,{width:22})})}),t.order_status==="New"?e.jsx(h,{title:"Edit Order",children:e.jsx(l,{color:"primary",onClick:()=>xe(t.order_id),children:e.jsx(Te,{width:22})})}):e.jsx(e.Fragment,{}),e.jsx(h,{title:"History",children:e.jsx(l,{color:"secondary",onClick:()=>A(t.order_id),children:e.jsx(R,{width:22})})})]}),e.jsx(n,{children:e.jsx(r,{variant:"subtitle2",children:v*p+s+1})}),e.jsx(n,{children:e.jsx(r,{color:"textSecondary",variant:"subtitle2",fontWeight:"400",children:t.order_id})}),e.jsx(n,{children:e.jsx(r,{color:"textSecondary",variant:"subtitle2",fontWeight:"400",children:_e(t.order_date)})}),e.jsx(n,{children:e.jsx(r,{color:"textSecondary",variant:"subtitle2",fontWeight:"400",children:t.product_type})}),e.jsx(n,{children:e.jsx(ke,{color:t.order_status==="Paid"?"success":t.order_status==="New"?"warning":t.order_status==="Cancelled"?"error":t.order_status==="Closed"?"primary":"secondary",sx:{borderRadius:"6px"},size:"small",label:t.order_status})}),e.jsx(n,{children:e.jsx(r,{color:"textSecondary",variant:"subtitle2",fontWeight:"400",children:t.customer_name})}),e.jsx(n,{children:e.jsx(r,{color:"textSecondary",variant:"subtitle2",fontWeight:"400",children:t.contact_phone.length>0?t.contact_phone:"-"})}),e.jsx(n,{children:e.jsx(r,{color:"textSecondary",variant:"subtitle2",fontWeight:"400",children:t.contact_wa.length>0?t.contact_wa:"-"})}),e.jsx(n,{children:e.jsx(r,{color:"textSecondary",variant:"subtitle2",fontWeight:"400",children:t.email_address.length>0?t.email_address:"-"})}),e.jsx(n,{children:e.jsx(r,{color:"textSecondary",variant:"subtitle2",fontWeight:"400",children:t.agent_code})}),e.jsx(n,{children:e.jsx(r,{color:"textSecondary",variant:"subtitle2",fontWeight:"400",children:t.agent_name})}),e.jsx(n,{children:e.jsx(r,{color:"textSecondary",variant:"subtitle2",fontWeight:"400",children:t.country_name})}),e.jsx(n,{children:e.jsx(r,{color:"textSecondary",variant:"subtitle2",fontWeight:"400",children:W(t.order_quantity)})}),e.jsx(n,{children:e.jsx(r,{color:"textSecondary",variant:"subtitle2",fontWeight:"400",children:W(t.total_order)})}),e.jsx(n,{children:e.jsx(r,{color:"textSecondary",variant:"subtitle2",fontWeight:"400",children:W(t.total_cost)})})]},s)),G>0&&e.jsx(L,{style:{height:53*G},children:e.jsx(n,{colSpan:2})})]}),e.jsx(fe,{children:e.jsx(L,{children:e.jsx(we,{rowsPerPageOptions:[5,10,25,{label:"All",value:-1}],colSpan:2,count:I.length,rowsPerPage:p,page:v,SelectProps:{native:!0},onPageChange:de,onRowsPerPageChange:ce,ActionsComponent:Ee})})})]})})})]})})};export{Xt as default};
