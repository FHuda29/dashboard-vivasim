import{R as C,r as c,y as oe,z as g,j as e}from"./index-pZ9xQgMg.js";import{B as ie}from"./Breadcrumb-CRa5l2zq.js";import{P as ne}from"./PageContainer-LYar8IhV.js";import{B as de}from"./BlankCard-jsHF22Za.js";import{C as n}from"./CustomFormLabel-DQZmNrva.js";import{C as h}from"./CustomSelect-C7618vxy.js";import{C as v}from"./CustomTextField-CVZyUcT3.js";import{g as ce,c as O}from"./Utils-eYPio9SP.js";import{A as S}from"./apiConstants-ChAepINk.js";import{C as ue}from"./CardContent-DHXKlgZi.js";import{B as A}from"./Box-DgOhk5yP.js";import{S as me}from"./Stack-DuXFRM8_.js";import{T as pe}from"./Typography-PCIzasSl.js";import{B as E}from"./Button-DrpnHyAw.js";import{D as ge}from"./Divider-BxeHuQda.js";import{G as s}from"./Grid2-TVAQUeLW.js";import{R as B}from"./RadioGroup-Cu9sV24W.js";import{F as b}from"./FormControlLabel-D6DjCZQh.js";import{R as y}from"./Radio-qxAK0tWc.js";import{M as x}from"./MenuItem-BUpQ2083.js";import{A as he}from"./Alert-XWH1BSQm.js";import"./Paper-Bglc4K2l.js";import"./useSlotProps-D9QVx9CU.js";import"./Link-DmIxGPWX.js";import"./IconCircle-CU5CO1wM.js";import"./createReactComponent-C7i1OeoA.js";import"./Card-Dnm4-j67.js";import"./Select-KnVOJfU6.js";import"./Menu-kcqCS8x-.js";import"./useSlot-C-z2829C.js";import"./Popover-ti3EBHaH.js";import"./isHostComponent-DVu5iVWx.js";import"./ownerDocument-DW-IO8s5.js";import"./ownerWindow-HkKU3E4x.js";import"./debounce-Be36O1Ab.js";import"./Grow-CByEer0C.js";import"./utils--BW9XhXC.js";import"./getReactElementRef-BDXd3hfF.js";import"./mergeSlotProps-D2utqxEY.js";import"./Modal-ETINFcPv.js";import"./createChainedFunction-BO_9K8Jh.js";import"./Portal-HPxiTNUe.js";import"./List-BgcNoc8S.js";import"./utils-iop7lDec.js";import"./useControlled-kCJ_Peco.js";import"./useId-DuuGdQhb.js";import"./formControlState-Dq1zat_P.js";import"./useFormControl-D34Ydy4-.js";import"./TextField-52YJDDYc.js";import"./FormControl-B2XRo0iR.js";import"./index-DuUv4AGY.js";import"./index-DT2YvziZ.js";import"./createStack-BEzwOkyd.js";import"./CircularProgress-KhQwCvJ5.js";import"./dividerClasses-BO-YFw3q.js";import"./FormGroup-DuQnWhWW.js";import"./SwitchBase-B9BuLIhz.js";import"./listItemTextClasses-B-a-vnZw.js";import"./Close-tbN14BDi.js";import"./IconButton-D8l5j-3s.js";const j=S.apiUrl,xe=[{to:"/",title:"Home"},{title:"Order"}],_e=[{id:0,value:"500",label:"500Mb"},{id:1,value:"1000",label:"1Gb"},{id:2,value:"2000",label:"2Gb"},{id:3,value:"3000",label:"3Gb"},{id:4,value:"5000",label:"5Gb"}],ve=[{id:0,value:"3000",label:"3Gb"},{id:1,value:"5000",label:"5Gb"},{id:2,value:"6000",label:"6Gb"},{id:3,value:"7000",label:"7Gb"},{id:4,value:"10000",label:"10Gb"},{id:5,value:"15000",label:"15Gb"},{id:6,value:"20000",label:"20Gb"},{id:7,value:"30000",label:"30Gb"}],be=[{id:0,value:"1",label:"1 day"},{id:1,value:"2",label:"2 day"},{id:2,value:"3",label:"3 day"},{id:3,value:"4",label:"4 day"},{id:4,value:"5",label:"5 day"},{id:5,value:"6",label:"6 day"},{id:6,value:"7",label:"7 day"},{id:7,value:"8",label:"8 day"},{id:8,value:"10",label:"10 day"},{id:9,value:"12",label:"12 day"},{id:10,value:"15",label:"15 day"},{id:11,value:"20",label:"20 day"},{id:12,value:"30",label:"30 day"}],ye=[{id:0,value:"1",label:"1"},{id:1,value:"2",label:"2"},{id:2,value:"3",label:"3"},{id:3,value:"4",label:"4"},{id:4,value:"5",label:"5"},{id:5,value:"6",label:"6"},{id:6,value:"7",label:"7"},{id:7,value:"8",label:"8"},{id:8,value:"9",label:"9"},{id:9,value:"10",label:"10"},{id:10,value:"11",label:"11"},{id:11,value:"12",label:"12"},{id:12,value:"13",label:"13"},{id:13,value:"14",label:"14"},{id:14,value:"15",label:"15"},{id:15,value:"16",label:"16"},{id:16,value:"17",label:"17"},{id:17,value:"18",label:"18"},{id:18,value:"19",label:"19"},{id:19,value:"20",label:"20"},{id:20,value:"21",label:"21"},{id:21,value:"22",label:"22"},{id:22,value:"23",label:"23"},{id:23,value:"24",label:"24"},{id:24,value:"25",label:"25"},{id:25,value:"26",label:"26"},{id:26,value:"27",label:"27"},{id:27,value:"28",label:"28"},{id:28,value:"29",label:"29"},{id:29,value:"30",label:"30"}],Ia=()=>{const[U,W]=C.useState([]),[je,fe]=C.useState([]),[Ce,M]=c.useState(""),[k,R]=c.useState(""),[L,T]=c.useState(""),[$,Q]=c.useState(""),[P,F]=c.useState(!0),[H,Se]=c.useState(!1),q=oe(),[l,_]=c.useState({seq:0,nama_pengguna:"",telp_pengguna:"",email_pengguna:"",agent_name:"",type:"",package_type:"",country:"ASIA16",days:0,fup:"",quota:"",quantity:1,product_id:"",product_price:0});c.useEffect(()=>{const a=localStorage.getItem("data_success_login");if(a){const t=JSON.parse(a);console.log("data_success_login:",t),console.log("user_name:",t.user_name),console.log("session_name:",t.session_name),console.log("session_level:",t.session_level),R(t.user_name),M(t.session_level),Q(t.session_name),J(t.session_name);const r=t.session_name.split("-")[0];T(r),K(r),_(u=>({...u,cobrand_id:t.session_name})),t.session_level.toLowerCase()}Y()},[]);const J=async a=>{let t=j+"agents/code/"+a;g.get(t).then(r=>{_(u=>({...u,agent_name:r.data[0].name}))}).catch(r=>{console.log(r)})},K=async a=>{let t=j+"product/partner/cobrand/"+a;g.get(t).then(r=>{console.log("list_product_partner : ",r.data)}).catch(r=>{console.log(r)})},V=async(a,t,r)=>{let u=j+"product/partner/"+a+"/"+t+"/"+r;g.get(u).then(async d=>{const G=L+ce(),te=O(),le=$;console.log("list_product_partner_detail : ",d.data),_(o=>({...o,product_id:d.data[0].package_id,product_price:d.data[0].selling_price}));const re=d.data[0].package_id,z=d.data[0].selling_price,I=l.quantity*z;console.log("total_product_price : ",I);let m=[];for(let o=0;o<f.length;o++)m[o]=l[`ccid_${o+1}`];console.log("ccid generate: ",m);let p="";for(let o=0;o<m.length;o++)m[o]!=""?p+=m[o]+"|":m[o]="";p=p.substring(0,p.length-1),console.log("ccid : ",p);const D={seq:0,order_id:G,order_date:te,order_type:l.type,order_status:"New",order_customer_name:l.nama_pengguna,order_contact_phone:l.telp_pengguna,order_contact_wa:l.telp_pengguna,order_contact_email:l.email_pengguna,order_agent_code:le,order_agent_name:l.agent_name,order_product:re,order_country_code:l.country,order_fup:l.fup,order_quota:l.quota,order_days:l.days,order_ccid:p,order_qty:l.quantity,order_product_price:z,order_product_total_price:I};console.log("dataOrder : ",D),await Z(D);const se=O();await ee({seq:0,order_id:G,event_name:"New Order",event_date:se,username:k}),q("/order/list")}).catch(d=>{alert("Product not found")})},i=a=>{const{name:t,value:r}=a.target;_(u=>{const d={...u,[t]:r};return d.package_type==="1"||d.package_type==="2"?F(!1):F(!0),{...d}})},X=async a=>{a.preventDefault();try{console.log("data : ",l),V(l.country,l.days,l.fup)}catch(t){console.error("Error adding orders:",t)}},Y=async()=>{let a=j+"country";g.get(a).then(t=>{W(t.data)}).catch(t=>{console.log(t)})},Z=async a=>{try{const r=(await g.post(S.apiUrl+"orders",a)).data}catch(t){console.error("Error adding orders:",t)}},ee=async a=>{try{const r=(await g.post(S.apiUrl+"order/event",a)).data}catch(t){console.error("Error adding order events :",t)}},ae=Array.from({length:30},(a,t)=>t+1),N=3,f=ae.slice(0,l.quantity),w=[];for(let a=0;a<f.length;a+=N)w.push(f.slice(a,a+N));return e.jsxs(ne,{title:"Create Simcard / eSIM",description:"this is Create Simcard/eSIM",children:[e.jsx(ie,{title:"Create Simcard / eSIM",items:xe}),e.jsx(de,{children:e.jsx(ue,{children:e.jsx("form",{onSubmit:X,children:e.jsxs(A,{children:[e.jsxs(me,{direction:"row",spacing:{xs:1,sm:2,md:4},justifyContent:"space-between",mb:3,children:[e.jsxs(pe,{variant:"h5",children:["#USER: ",k]}),e.jsxs(A,{display:"flex",gap:1,children:[e.jsx(E,{variant:"outlined",color:"error",onClick:()=>{q("/order/list")},children:"Cancel"}),e.jsx(E,{type:"submit",variant:"contained",color:"primary",children:"Save Record"})]})]}),e.jsx(ge,{}),e.jsxs(s,{container:!0,spacing:3,children:[e.jsxs(s,{size:{xs:12,sm:4},children:[e.jsx(n,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Nama Pengguna"}),e.jsx(v,{id:"nama_pengguna",name:"nama_pengguna",value:l.nama_pengguna,onChange:i,fullWidth:!0})]}),e.jsxs(s,{size:{xs:12,sm:4},children:[e.jsx(n,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Nomor Telepon Pengguna"}),e.jsx(v,{id:"telp_pengguna",name:"telp_pengguna",value:l.telp_pengguna,onChange:i,fullWidth:!0,type:"phone"})]}),e.jsxs(s,{size:{xs:12,sm:4},children:[e.jsx(n,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Email Pengguna"}),e.jsx(v,{id:"email_pengguna",name:"email_pengguna",value:l.email_pengguna,onChange:i,fullWidth:!0,type:"email"})]}),e.jsxs(s,{size:{xs:12,sm:4},children:[e.jsx(n,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Type"}),e.jsxs(B,{"aria-labelledby":"demo-radio-buttons-group-label",value:l.type,onChange:i,id:"type",name:"type",row:!0,children:[e.jsx(b,{value:"Simcard",control:e.jsx(y,{}),label:"Simcard"}),e.jsx(b,{value:"eSIM",control:e.jsx(y,{}),label:"eSIM"})]})]}),e.jsxs(s,{size:{xs:12,sm:4},children:[e.jsx(n,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Country"}),e.jsx(h,{id:"country",name:"country",value:l.country,onChange:i,fullWidth:!0,children:U.map(a=>e.jsx(x,{value:a.country_code,children:a.country_list},a.seq))})]}),e.jsx(s,{size:{xs:12,sm:4},children:"Â "}),e.jsxs(s,{size:{xs:12,sm:4},children:[e.jsx(n,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Product Type"}),e.jsxs(B,{"aria-labelledby":"radio-buttons-group-package",value:l.package_type,onChange:i,id:"package_type",name:"package_type",row:!0,children:[e.jsx(b,{value:"1",control:e.jsx(y,{}),label:"Unlimited"}),e.jsx(b,{value:"2",control:e.jsx(y,{}),label:"Quota Based"})]})]}),e.jsxs(s,{size:{xs:12,sm:4},children:[e.jsx(n,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Product Package"}),l.package_type==="1"?e.jsx(h,{id:"fup",name:"fup",value:l.fup,onChange:i,fullWidth:!0,children:_e.map(a=>e.jsx(x,{value:a.value,children:a.label},a.id))}):l.package_type==="2"?e.jsx(h,{id:"quota",name:"quota",value:l.quota,onChange:i,fullWidth:!0,children:ve.map(a=>e.jsx(x,{value:a.value,children:a.label},a.id))}):e.jsx(h,{id:"package",name:"package",fullWidth:!0,disabled:!0,children:e.jsx(x,{value:"",children:"Select Package"})})]}),e.jsxs(s,{size:{xs:12,sm:4},children:[e.jsx(n,{htmlFor:"Days",sx:{mt:{xs:0,sm:3}},children:"Days"}),e.jsx(h,{id:"days",name:"days",value:l.days,onChange:i,fullWidth:!0,disabled:P,children:be.map(a=>e.jsx(x,{value:a.value,children:a.label},a.id))})]}),e.jsxs(s,{size:{xs:12,sm:2},children:[e.jsx(n,{htmlFor:"PackageName",sx:{mt:{xs:0,sm:3}},children:"Quantity"}),e.jsx(h,{id:"quantity",name:"quantity",value:l.quantity,onChange:i,fullWidth:!0,disabled:P,children:ye.map(a=>e.jsx(x,{value:a.value,children:a.label},a.id))})]})]}),e.jsx(s,{size:{xs:12,sm:12},children:e.jsx(n,{htmlFor:"title_price",sx:{mt:3,mb:2},children:"ICCID - (eSIM tdk perlu di isi)"})}),w.map((a,t)=>e.jsx(s,{container:!0,spacing:2,children:a.map(r=>e.jsxs(C.Fragment,{children:[e.jsx(s,{size:{xs:12,sm:1},children:e.jsxs(n,{htmlFor:`ccid_${r}`,sx:{mt:1,textAlign:"center"},children:[r,"."]})}),e.jsx(s,{size:{xs:12,sm:3},children:e.jsx(v,{id:`ccid_${r}`,name:`ccid_${r}`,value:l[`ccid_${r}`]||"",onChange:i,fullWidth:!0,sx:{mt:1}})})]},r))},t)),H&&e.jsx(he,{severity:"success",sx:{position:"fixed",top:16,right:16},children:"Order created successfully."})]})})})})]})};export{Ia as default};
