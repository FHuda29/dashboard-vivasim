import{y as ae,r as a,j as e,L as q}from"./index-bBoaL7NX.js";import{T as re,L as E,F as N,K as z}from"./LastPage-CUO0XoGI.js";import{K as O}from"./KeyboardArrowRight-CL0uG8E4.js";import{P as ie}from"./PageContainer-ClH7HaBW.js";import{P as le}from"./ParentCard-CFe-nEgX.js";import{B as ce}from"./BlankCard-BfHU7njI.js";import{f as de}from"./Utils-DZtz8wsc.js";import{i as f}from"./axios-MmGZYXFl.js";import{j as pe}from"./index-VWaDGczM.js";import{B as D}from"./Box-Cbtftx36.js";import{S as me}from"./Stack-DONMPCRZ.js";import{T as he}from"./TextField-CNoxaAXv.js";import{I as xe}from"./InputAdornment-DDw9KCxJ.js";import{I as ue}from"./IconSearch-8WAl2z6L.js";import{B as k}from"./Button-2ihUhOt_.js";import{T as je}from"./TableContainer-OLbhJ7zr.js";import{T as ge,a as fe,b as C,c as o,d as ke}from"./TableRow-Zqkg4FIQ.js";import{T as n}from"./Typography-B41TU7cT.js";import{T as w}from"./Tooltip-CRAcMsX-.js";import{I as p}from"./IconButton-6ozhzS-w.js";import{c as $}from"./createReactComponent-BVlLIvSm.js";import{I as be}from"./IconRowRemove-EM_Win1C.js";import{T as ve}from"./TablePagination-DdevPbi4.js";import{D as H,a as V}from"./DialogContent-BJGxlzU1.js";import{D as W}from"./DialogTitle-37dVBM_z.js";import{D as Y}from"./DialogActions-r0byN1sA.js";import{u as Ce}from"./Paper-CEo52ZYq.js";import"./createSvgIcon-DcL-YXBs.js";import"./mergeSlotProps-9a9CFyBb.js";import"./createChainedFunction-BO_9K8Jh.js";import"./debounce-Be36O1Ab.js";import"./isMuiElement-CYEUdTOG.js";import"./ownerDocument-DW-IO8s5.js";import"./ownerWindow-HkKU3E4x.js";import"./useId-BgKtfLA5.js";import"./useControlled-B6T_fxKa.js";import"./Card-DDyARx6g.js";import"./CardHeader-BGxrrKRe.js";import"./useSlot-C2y4Okaq.js";import"./Divider-4e_Zm7wz.js";import"./dividerClasses-D6e-UzmO.js";import"./CardContent-TrRQSIz8.js";import"./index-J11PKsb-.js";import"./index-DT2YvziZ.js";import"./apiConstants-C71iLEz3.js";import"./createStack-D5Eniu1T.js";import"./styled-oSX1ZV8o.js";import"./useThemeProps-BUO-Zg8Q.js";import"./Select-x3FgNbWv.js";import"./Menu-DsMCwLnz.js";import"./useSlotProps-D8Vfx1ig.js";import"./Popover-BZ_q2ihg.js";import"./isHostComponent-DVu5iVWx.js";import"./Grow-DbIyLDOd.js";import"./utils-fXVEFgwU.js";import"./getReactElementRef-bhjrj0fa.js";import"./Modal-B5yRmzaP.js";import"./Portal-PELJNkOL.js";import"./List-BNgu_2yQ.js";import"./utils-iop7lDec.js";import"./formControlState-Dq1zat_P.js";import"./useFormControl-CaUBXsoR.js";import"./FormControl-BPBqqdCO.js";import"./CircularProgress-BIjyWvHZ.js";import"./Popper-ppbRY3WN.js";import"./KeyboardArrowRight-BUHflnHK.js";import"./LastPage-CryT0fTs.js";import"./MenuItem-DBmnqxHM.js";import"./listItemTextClasses-DSEuY2ct.js";import"./Toolbar-BWjUcWdc.js";var ye=$("accessible","IconAccessible",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M10 16.5l2 -3l2 3m-2 -3v-2l3 -1m-6 0l3 1",key:"svg-1"}],["circle",{cx:"12",cy:"7.5",r:".5",fill:"currentColor",key:"svg-2"}]]),Pe=$("key","IconKey",[["path",{d:"M16.555 3.843l3.602 3.602a2.877 2.877 0 0 1 0 4.069l-2.643 2.643a2.877 2.877 0 0 1 -4.069 0l-.301 -.301l-6.558 6.558a2 2 0 0 1 -1.239 .578l-.175 .008h-1.172a1 1 0 0 1 -.993 -.883l-.007 -.117v-1.172a2 2 0 0 1 .467 -1.284l.119 -.13l.414 -.414h2v-2h2v-2l2.144 -2.144l-.301 -.301a2.877 2.877 0 0 1 0 -4.069l2.643 -2.643a2.877 2.877 0 0 1 4.069 0z",key:"svg-0"}],["path",{d:"M15 9h.01",key:"svg-1"}]]);function Be(m){const d=Ce(),{count:j,page:l,rowsPerPage:h,onPageChange:i}=m,b=c=>{i(c,0)},y=c=>{i(c,l-1)},P=c=>{i(c,l+1)},B=c=>{i(c,Math.max(0,Math.ceil(j/h)-1))};return e.jsxs(D,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(p,{onClick:b,disabled:l===0,"aria-label":"first page",children:d.direction==="rtl"?e.jsx(E,{}):e.jsx(N,{})}),e.jsx(p,{onClick:y,disabled:l===0,"aria-label":"previous page",children:d.direction==="rtl"?e.jsx(O,{}):e.jsx(z,{})}),e.jsx(p,{onClick:P,disabled:l>=Math.ceil(j/h)-1,"aria-label":"next page",children:d.direction==="rtl"?e.jsx(z,{}):e.jsx(O,{})}),e.jsx(p,{onClick:B,disabled:l>=Math.ceil(j/h)-1,"aria-label":"last page",children:d.direction==="rtl"?e.jsx(N,{}):e.jsx(E,{})})]})}const Os=()=>{const m=ae(),[d,j]=a.useState(""),[l,h]=a.useState("");a.useEffect(()=>{const s=localStorage.getItem("token");if(s){const t=pe(s);if(j(t.session_level),t.session_level.toLowerCase()==="partner"||t.session_level.toLowerCase()==="partner-admin"){const r=t.session_name.split("-")[0];h(r),b(r)}else h(t.session_name),i()}else m("/auth/login")},[]);const i=async()=>{f.get("users").then(t=>{I(t.data)}).catch(t=>{t.response&&t.response.status===403||t.response.status===401?m("/auth/login"):console.log(t)})},b=async s=>{let t="users/cobrand/"+s;f.get(t).then(r=>{I(r.data)}).catch(r=>{r.response&&r.response.status===403||r.response.status===401?m("/auth/login"):console.log(r)})},y=s=>{console.log(s.target.value),B(s.target.value);const t=s.target.value;if(t.length!==0){let r="users/search?param="+t;f.get(r).then(u=>{I(u.data)}).catch(u=>{u.response&&u.response.status===403||u.response.status===401?m("/auth/login"):console.log(u)})}else d.toLowerCase()==="partner"||d.toLowerCase()==="partner-admin"?b(l):i()},[P,B]=a.useState(""),[c,Se]=a.useState(!1),[G,S]=a.useState(!1),[J,T]=a.useState(!1),[L,U]=a.useState(0),[A,_]=a.useState(""),Q=(s,t)=>{_(s),U(t),S(!0)},R=()=>{S(!1)},X=(s,t)=>{_(s),U(t),T(!0)},M=()=>{T(!1)},[Z,I]=a.useState([]),v=Z,[g,F]=a.useState(0),[x,ee]=a.useState(10),K=g>0?Math.max(0,(1+g)*x-v.length):0,se=(s,t)=>{F(t)},te=s=>{ee(parseInt(s.target.value,10)),F(0)},oe=async()=>{const s={blocked:"Y"};try{await f.put("users/block/"+L,s),S(!1),i()}catch(t){console.error("Error block users:",t)}},ne=async()=>{const s={blocked:"N"};try{await f.put("users/block/"+L,s),T(!1),i()}catch(t){console.error("Error unblock users:",t)}};return e.jsxs(ie,{title:"Users",description:"this is users page",children:[e.jsxs(le,{title:"User List",children:[e.jsx(D,{mb:2,children:e.jsxs(me,{mt:3,justifyContent:"space-between",direction:{xs:"column",sm:"row"},spacing:{xs:1,sm:2,md:4},children:[e.jsx(he,{id:"search",type:"text",size:"small",variant:"outlined",value:P,onChange:y,InputProps:{endAdornment:e.jsx(xe,{position:"end",children:e.jsx(ue,{size:"16"})})}}),e.jsx(D,{display:"flex",gap:1,children:e.jsx(k,{variant:"contained",color:"primary",component:q,to:"/apps/user/create",children:"Add User Web Login"})})]})}),e.jsx(ce,{children:e.jsx(je,{children:e.jsxs(ge,{"aria-label":"custom pagination table",sx:{whiteSpace:"nowrap"},children:[e.jsx(fe,{children:e.jsxs(C,{children:[e.jsx(o,{children:e.jsx(n,{variant:"subtitle2",children:"User Name"})}),e.jsx(o,{children:e.jsx(n,{variant:"subtitle2",children:"Partner/Agent ID"})}),e.jsx(o,{children:e.jsx(n,{variant:"subtitle2",children:"Level"})}),e.jsx(o,{children:e.jsx(n,{variant:"subtitle2",children:"Blocked"})}),e.jsx(o,{children:e.jsx(n,{variant:"subtitle2",children:"Failed"})}),e.jsx(o,{children:e.jsx(n,{variant:"subtitle2",children:"Last Login"})}),e.jsx(o,{children:e.jsx(n,{variant:"subtitle2",children:"Action"})})]})}),e.jsxs(ke,{children:[(x>0?v.slice(g*x,g*x+x):v).map((s,t)=>e.jsxs(C,{children:[e.jsx(o,{children:e.jsx(n,{variant:"caption",children:s.user_name})}),e.jsx(o,{children:e.jsx(n,{variant:"caption",children:s.session_name})}),e.jsx(o,{children:e.jsx(n,{variant:"caption",children:s.session_level})}),e.jsx(o,{children:e.jsx(n,{variant:"caption",children:s.blocked})}),e.jsx(o,{children:e.jsx(n,{variant:"caption",children:s.failed})}),e.jsx(o,{children:e.jsx(n,{variant:"caption",children:de(s.last_login_time)})}),e.jsxs(o,{children:[e.jsx(w,{title:"Reset Password",children:e.jsx(p,{color:"success",component:q,to:`/apps/user/change-password/${s.seq}`,children:e.jsx(Pe,{width:22})})}),e.jsx(w,{title:"Block",children:e.jsx(p,{color:"error",onClick:()=>Q(s.user_name,s.seq),children:e.jsx(be,{width:22})})}),e.jsx(w,{title:"Unblock",children:e.jsx(p,{color:"info",onClick:()=>X(s.user_name,s.seq),children:e.jsx(ye,{width:22})})})]})]},t)),K>0&&e.jsx(C,{style:{height:53*K},children:e.jsx(o,{colSpan:1})})]}),e.jsx(re,{children:e.jsx(C,{children:e.jsx(ve,{rowsPerPageOptions:[5,10,25,{label:"All",value:-1}],colSpan:1,count:v.length,rowsPerPage:x,page:g,SelectProps:{native:!0},onPageChange:se,onRowsPerPageChange:te,ActionsComponent:Be})})})]})})})]}),e.jsxs(H,{open:G,onClose:R,children:[e.jsx(W,{children:"Confirm Block"}),e.jsxs(V,{children:['Are you sure you want to block selected username "',A,'" ?']}),e.jsxs(Y,{children:[e.jsx(k,{variant:"contained",onClick:R,children:"Cancel"}),e.jsx(k,{color:"error",variant:"outlined",onClick:oe,children:"Block"})]})]}),e.jsxs(H,{open:J,onClose:M,children:[e.jsx(W,{children:"Confirm Block"}),e.jsxs(V,{children:['Are you sure you want to unblock selected username "',A,'" ?']}),e.jsxs(Y,{children:[e.jsx(k,{variant:"contained",onClick:M,children:"Cancel"}),e.jsx(k,{color:"error",variant:"outlined",onClick:ne,children:"Unblock"})]})]})]})};export{Os as default};
